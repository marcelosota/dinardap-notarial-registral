<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:p="http://primefaces.org/ui">


    <ui:composition template="/template/general.xhtml">
        <ui:define name="content">
            <h1 class="h-wai">#{etiquetas['nombre.sistema']} - Registrar Usuario</h1>
            <h:form id="formInicio">
            	<p:panel style="width:100%;">
	                <h:panelGrid columns="2" id="logueo" style="width:90%;"
						columnClasses="form-label-derecha, form-input-izquierda"> 
	                             
	                    <p:outputLabel value="#{etiquetas['documento.identificacion']}*:" />
	                    <p:inputText id="txtCedula"
	                                 value="#{registroUsuarioCtrl.usuarioDto.cedula}"
	                                 maxlength="10"
	                                 required="true"
	                                 requiredMessage="#{etiquetas['documento.identificacion']} #{mensajes['requerido']}">
	                        <f:validateRegex pattern="[0-9]+" />
	                        <p:ajax event="blur" listener="#{registroUsuarioCtrl.buscarUsuario}" update="txtNombre"/>
	                    </p:inputText>
	                    <p:outputLabel value="#{etiquetas['nombre']}*:" />
	                    <p:inputText id="txtNombre" 
							value="#{registroUsuarioCtrl.usuarioDto.nombre}"
	                        disabled="true"
	                        required="true"
	                        requiredMessage="#{etiquetas['nombre']} #{mensajes['requerido']}"
	                        size="40" />
						<p:outputLabel value="#{etiquetas['cargo']}:" />
						<p:inputText id="txtCargo"
							value="#{registroUsuarioCtrl.usuarioDto.cargo}"
							size="40"
							maxlength="32" />
						<p:outputLabel value="#{etiquetas['correo.electronico']}*:" />
						<p:inputText id="txtCorreo"
							value="#{registroUsuarioCtrl.usuarioDto.correoElectronico}"
							size="40"
							maxlength="256"
							required="true"
							requiredMessage="#{etiquetas['correo.electronico']} #{mensaje['requerido']}" />
	                    <p:outputLabel value="#{etiquetas['telefono']}*:" />
						<p:inputText id="txtTelefono"
							value="#{registroUsuarioCtrl.usuarioDto.telefono}"
							size="10"
							maxlength="10"
							required="true"
							requiredMessage="#{etiquetas['telefono']} #{mensaje['requerido']}" />
	                    <p:outputLabel value="#{etiquetas['contrasena']}*:" />
	                    <p:password id="txtContrasena" 
	                        value="#{registroUsuarioCtrl.usuarioDto.contrasena}" 
	                        required="true"
	                        requiredMessage="#{etiquetas['contrasena']} #{mensajes['requerido']}"
	                        size="40" />
	                    <p:outputLabel value="#{etiquetas['asignar.institucion']}:" />
	                    <p:selectBooleanButton onLabel="Si" offLabel="No" value="#{registroUsuarioCtrl.asignarEntidad}">
	                    	<p:ajax event="change" update="pnlSalida" 
	                    		process="@this" listener="#{registroUsuarioCtrl.habilitarPanel}" />
	                    </p:selectBooleanButton>
	                </h:panelGrid>
                </p:panel>
                <p:outputPanel id="pnlSalida">
	                <p:panel id="pnlEntidad" style="width:100%;" rendered="#{registroUsuarioCtrl.asignarEntidad}">
		                <h:panelGrid columns="2" style="width:90%;"
	                             columnClasses="form-label-derecha, form-input-izquierda">
		                	<p:outputLabel value="#{etiquetas['provincia']}*:" />
		                	<p:selectOneMenu id="cmbProvincia" 
								value="#{registroUsuarioCtrl.usuarioDto.provinciaId}" 
								style="font-size:x-small; width: 100%;">
								<p:ajax event="change" process="@this"
									listener="#{registroUsuarioCtrl.cantonPorProvincia}"
									update="@this cmbCanton cmbTipoInstitucion cmbEntidades" />
								<f:selectItem itemLabel="#{etiquetas['seleccionar']}" noSelectionOption="true" itemValue="-1"/>
								<f:selectItems value="#{registroUsuarioCtrl.provincia}" var="pro"
									itemLabel="#{pro.nombre}" itemValue="#{pro.provinciaId}"/>
							</p:selectOneMenu>
							<p:outputLabel value="#{etiquetas['canton']}*:" />
							<p:selectOneMenu id="cmbCanton" 
								value="#{registroUsuarioCtrl.usuarioDto.cantonId}"
								disabled="#{registroUsuarioCtrl.flagCanton}"
								style="font-size:x-small; width:100%">
								<p:ajax event="change" listener="#{registroUsuarioCtrl.cantonSeleccionado}" 
									update="cmbTipoInstitucion cmbEntidades" />
								<f:selectItem itemLabel="#{etiquetas['seleccionar']}" noSelectionOption="true"/>
								<f:selectItems value="#{registroUsuarioCtrl.canton}" var="can"
									itemLabel="#{can.nombre}" itemValue="#{can.cantonId}" />
							</p:selectOneMenu>
							<p:outputLabel value="#{etiquetas['tipo.institucion']}*:" />
							<p:selectOneMenu id="cmbTipoInstitucion" 
								value="#{registroUsuarioCtrl.usuarioDto.tipoInstitucionId}" 
								style="font-size:x-small; width:100%">
								<p:ajax event="change" update="cmbEntidades" 
									listener="#{registroUsuarioCtrl.buscarInstitucion}" 
									process="@this cmbCanton"/>
								<f:selectItem itemLabel="#{etiquetas['seleccionar']}" noSelectionOption="true" itemValue="-1"/>
								<f:selectItems value="#{registroUsuarioCtrl.listaTipoInstitucion}" var="tipo"
									itemLabel="#{tipo.descripcion}" itemValue="#{tipo.tipoInstitucionId}" />
							</p:selectOneMenu>
		                    <p:outputLabel value="#{etiquetas['nombre.institucion']}*:" />
		                    <p:selectOneMenu id="cmbEntidades" 
								value="#{registroUsuarioCtrl.usuarioDto.institucionId}"
		                        required="true"
		                        required-message="#{etiquetas['nombre.institucion']} #{mensajes['requerido']}"
		                        styleClass="form-combo-centrado">
		                        <f:selectItem itemLabel="#{etiquetas['seleccionar']}" itemValue="-1" noSelectionOption="true" />
		                        <f:selectItems value="#{registroUsuarioCtrl.listaInstituciones}" var="inst" 
		                        	itemLabel="#{inst.nombre}" itemValue="#{inst.institucionId}"/>
		                    </p:selectOneMenu>
		                </h:panelGrid>
	                </p:panel>
                </p:outputPanel>
                <p:commandButton value="#{etiquetas['guardar']}"
                                 actionListener="#{registroUsuarioCtrl.guardarUsuario}"
                                 update="txtCedula txtNombre txtContrasena cmbEntidades msgMensajes"/>
                <p:spacer width="10px" />
                <p:commandButton value="#{etiquetas['cancelar']}"
                                 actionListener="#{registroUsuarioCtrl.limpiarCampos}"
                                 update="txtCedula txtNombre txtContrasena cmbEntidades msgMensajes"
                                 process="@this" />
            </h:form>
        </ui:define>
    </ui:composition>
</html>